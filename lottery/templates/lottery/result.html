{% extends 'lottery/base.html' %}
{% load humanize %}
{% load custom_filters %} 


{% block content %}
<div class="row justify-content-center">
    <div class="col-md-8">
        <div class="card shadow">
            <div class="card-header bg-primary text-white">
                <h3 class="mb-0">Result for Ticket: {{ ticket_code }}</h3>
            </div>
            <div class="card-body">
                {% if error %}
                    <div class="alert alert-danger">
                        <h4>Error</h4>
                        <p>{{ error }}</p>
                    </div>
                {% elif prizes %}
                    {% if has_exact_match %}
                    <div class="alert alert-success">
                        <h4>Congratulations! Exact Match Found!</h4>
                        <p>Your ticket <strong>{{ ticket_code }}</strong> won a prize!</p>
                    </div>
                    {% else %}
                    <div class="alert alert-info">
                        <h4>Partial Match Found</h4>
                        <p>Your ticket's last 4 digits (<strong>{{ last_4_digits }}</strong>) matched a winning number.</p>
                    </div>
                    {% endif %}
                    
                    <div class="row">
                        {% for prize in prizes %}
                        <div class="col-md-6 mb-3">
                            <div class="card prize-card h-100 
                                {% if prize.prize_type == '1st' %}border-success border-3
                                {% elif prize.prize_type == '2nd' %}border-primary border-3
                                {% elif prize.prize_type == '3rd' %}border-info border-3
                                {% else %}border-secondary{% endif %}">
                                <div class="card-body">
                                    <h5 class="card-title">{{ prize.get_prize_type_display }}</h5>
                                    <p class="card-text">
                                        <strong>Amount:</strong> â‚¹{{ prize.amount|intcomma }}<br>
                                        <strong>Ticket Code:</strong> 
                                        {% if prize.prize_type == '1st' or prize.prize_type == '2nd' or prize.prize_type == '3rd' or prize.prize_type == 'cons' %}
                                            {{ prize.ticket_code }}
                                        {% else %}
                                            Ending with: <span class="text-danger">{{ prize.ticket_code }}</span>
                                        {% endif %}
                                        <br>
                                        {% if prize.location %}
                                        <strong>Location:</strong> {{ prize.location }}<br>
                                        {% endif %}
                                    </p>
                                </div>
                            </div>
                        </div>
                        {% endfor %}
                    </div>
                {% else %}
                    <div class="alert alert-warning">
                        <h4>No Winning Results Found</h4>
                        <p>Your ticket <strong>{{ ticket_code }}</strong> did not win any prizes in the selected draw.</p>
                    </div>
                {% endif %}
                
                <div class="mt-3">
                    <a href="{% url 'home' %}" class="btn btn-primary">Check Another Ticket</a>
                </div>
            </div>
        </div>
    </div>
</div>
{% endblock %}